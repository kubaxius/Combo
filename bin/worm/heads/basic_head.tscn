[gd_scene load_steps=11 format=3 uid="uid://camjvgx5kvtmh"]

[ext_resource type="Script" uid="uid://lsuqgvu148ih" path="res://worm/base/head/head.gd" id="1_asjjq"]
[ext_resource type="Script" uid="uid://ckg6s6fhru2uv" path="res://worm/base/head/components/follow_mouse.gd" id="2_oxss4"]
[ext_resource type="Texture2D" uid="uid://bncyhw4v2cw1u" path="res://worm/assets/worm_head.png" id="3_lnd62"]
[ext_resource type="Script" uid="uid://c23msscfhcgae" path="res://components/leave_trail.gd" id="4_bnwxt"]
[ext_resource type="Script" uid="uid://car5i8e3rlaxi" path="res://addons/godot_state_charts/state_chart.gd" id="5_jg30f"]
[ext_resource type="Script" uid="uid://w1w66en5t7v1" path="res://worm/base/components/ground_checker.gd" id="5_xreio"]
[ext_resource type="Script" uid="uid://6rnr5ee3s4j3" path="res://addons/godot_state_charts/compound_state.gd" id="6_2m4l2"]
[ext_resource type="Script" uid="uid://cp0gcn2oc6f1v" path="res://addons/godot_state_charts/atomic_state.gd" id="7_xreio"]
[ext_resource type="Script" uid="uid://brbkwqgqhymfi" path="res://addons/godot_state_charts/transition.gd" id="8_8lhov"]

[sub_resource type="CircleShape2D" id="CircleShape2D_lwm3e"]
radius = 40.3113

[node name="BasicWormHead" type="CharacterBody2D" groups=["needs_worm_speed", "needs_worm_turning_speed"]]
collision_mask = 0
motion_mode = 1
script = ExtResource("1_asjjq")

[node name="WormHead" type="Sprite2D" parent="."]
texture = ExtResource("3_lnd62")

[node name="FollowMouse" type="Node2D" parent="."]
script = ExtResource("2_oxss4")

[node name="LeaveTrail" type="Node2D" parent="."]
script = ExtResource("4_bnwxt")
texture = ExtResource("3_lnd62")

[node name="GroundChecker" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 2
script = ExtResource("5_xreio")
metadata/_custom_type_script = ExtResource("5_xreio")

[node name="CollisionShape2D" type="CollisionShape2D" parent="GroundChecker"]
shape = SubResource("CircleShape2D_lwm3e")
debug_color = Color(0.825765, 0.00158581, 0.954354, 0.42)

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("CircleShape2D_lwm3e")

[node name="MainCamera" type="Camera2D" parent="."]
position_smoothing_enabled = true

[node name="PhysicsStateChart" type="Node" parent="."]
script = ExtResource("5_jg30f")
metadata/_custom_type_script = ExtResource("5_jg30f")

[node name="Root" type="Node" parent="PhysicsStateChart"]
script = ExtResource("6_2m4l2")
initial_state = NodePath("GroundedState")

[node name="GroundedState" type="Node" parent="PhysicsStateChart/Root"]
script = ExtResource("7_xreio")

[node name="ToAirborn" type="Node" parent="PhysicsStateChart/Root/GroundedState"]
script = ExtResource("8_8lhov")
to = NodePath("../../AirbornState")
event = &"segment_exited_ground"
delay_in_seconds = "0.0"

[node name="AirbornState" type="Node" parent="PhysicsStateChart/Root"]
script = ExtResource("7_xreio")

[node name="ToGrounded" type="Node" parent="PhysicsStateChart/Root/AirbornState"]
script = ExtResource("8_8lhov")
to = NodePath("../../GroundedState")
event = &"segment_entered_ground"
delay_in_seconds = "0.0"

[connection signal="grounded_state_changed" from="GroundChecker" to="." method="_on_ground_checker_comp_grounded_state_changed"]
[connection signal="state_physics_processing" from="PhysicsStateChart/Root/GroundedState" to="." method="_grounded_state_physics_processing"]
[connection signal="state_physics_processing" from="PhysicsStateChart/Root/AirbornState" to="." method="_airborn_state_physics_processing"]
